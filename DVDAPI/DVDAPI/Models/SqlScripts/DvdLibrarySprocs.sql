USE DVDLibrary
GO

IF EXISTS(
	SELECT *
	FROM INFORMATION_SCHEMA.ROUTINES
	WHERE ROUTINE_NAME = 'GetAll'
)
BEGIN
	DROP PROCEDURE GetAll
END
GO

CREATE PROCEDURE GetAll
AS

SELECT *
FROM DVDsADO
ORDER BY [DVD ID]

GO

IF EXISTS(
	SELECT *
	FROM INFORMATION_SCHEMA.ROUTINES
	WHERE ROUTINE_NAME = 'GetByID'
)
BEGIN
	DROP PROCEDURE GetByID
END
GO

CREATE PROCEDURE GetByID(
	@ID int
)
AS

SELECT *
FROM DVDsADO
WHERE [DVD ID] = @ID
ORDER BY [DVD ID]

GO

IF EXISTS(
	SELECT *
	FROM INFORMATION_SCHEMA.ROUTINES
	WHERE ROUTINE_NAME = 'GetByTitle'
)
BEGIN
	DROP PROCEDURE GetByTitle
END
GO

CREATE PROCEDURE GetByTitle(
	@Title nvarchar(50)
)
AS

SELECT *
FROM DVDsADO
WHERE [Title] LIKE @Title
ORDER BY [DVD ID]

GO

IF EXISTS(
	SELECT *
	FROM INFORMATION_SCHEMA.ROUTINES
	WHERE ROUTINE_NAME = 'GetByYear'
)
BEGIN
	DROP PROCEDURE GetByYear
END
GO

CREATE PROCEDURE GetByYear(
	@Year int
)
AS

SELECT *
FROM DVDsADO
WHERE [Release Year] = @Year
ORDER BY [DVD ID]

GO

IF EXISTS(
	SELECT *
	FROM INFORMATION_SCHEMA.ROUTINES
	WHERE ROUTINE_NAME = 'GetByDirector'
)
BEGIN
	DROP PROCEDURE GetByDirector
END
GO

CREATE PROCEDURE GetByDirector(
	@Name nvarchar(50)
)
AS

SELECT *
FROM DVDsADO
WHERE [Director] LIKE @Name
ORDER BY [DVD ID]

GO

IF EXISTS(
	SELECT *
	FROM INFORMATION_SCHEMA.ROUTINES
	WHERE ROUTINE_NAME = 'GetByRating'
)
BEGIN
	DROP PROCEDURE GetByRating
END
GO

CREATE PROCEDURE GetByRating(
	@Rating nvarchar(50)
)
AS

SELECT *
FROM DVDsADO
WHERE [Rating] = @Rating
ORDER BY [DVD ID]

GO

IF EXISTS(
	SELECT *
	FROM INFORMATION_SCHEMA.ROUTINES
	WHERE ROUTINE_NAME = 'NewDVD'
)
BEGIN
	DROP PROCEDURE NewDVD
END
GO

CREATE PROCEDURE NewDVD(
	@Title nvarchar(50),
	@Year int,
	@Name nvarchar(50),
	@Rating nvarchar(50),
	@Notes nvarchar(50)
)
AS

INSERT INTO DVDsADO
([Title],[Release Year],[Director],[Rating],[Notes])
VALUES
(@Title,@Year,@Name,@Rating,@Notes);

GO

IF EXISTS(
	SELECT *
	FROM INFORMATION_SCHEMA.ROUTINES
	WHERE ROUTINE_NAME = 'UpdateDVD'
)
BEGIN
	DROP PROCEDURE UpdateDVD
END
GO

CREATE PROCEDURE UpdateDVD(
	@ID int,
	@Title nvarchar(50),
	@Year int,
	@Name nvarchar(50),
	@Rating nvarchar(50),
	@Notes nvarchar(50)
)
AS

UPDATE DVDsADO
SET Title = @Title, [Release Year] = @Year, [Director] = @Name, [Rating] = @Rating, [Notes] = @Notes
WHERE [DVD ID] = @ID;

GO

IF EXISTS(
	SELECT *
	FROM INFORMATION_SCHEMA.ROUTINES
	WHERE ROUTINE_NAME = 'DeleteDVD'
)
BEGIN
	DROP PROCEDURE DeleteDVD
END
GO

CREATE PROCEDURE DeleteDVD(
	@ID int
)
AS

DELETE FROM DVDsADO
WHERE [DVD ID] = @ID;

GO